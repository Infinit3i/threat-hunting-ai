## Anti Debugging
- EnumWindows & Suspend Thread
Prevention: Locate these calls and fill with NOP

## Anti VM
- EnumProcess API
- Check for installed programs
- Check OUI
- Check Resource Consumption
Prevention: [VMWareCloak](https://github.com/d4rksystem/VMwareCloak) or [VBoxCloak](https://github.com/d4rksystem/VBoxCloak)

## Packer
- PELock
- Themida
Prevention: [DetectitEasy](https://github.com/horsicq/Detect-It-Easy) and [PEstudio](https://www.winitor.com/download) to ID packers


- how malware creators know if debuggers are running

1. this will check if a debugger is present [^1]
    - C++ code - below main()  
```
{
if (IsDebuggerPresent()) {
    puts("[+] under the microscope");
    return 0;
    }
}
```

2. check if debugger is present by name
3. hand made debugger


[^1]: [How Does Malware Know It's Being Monitored?](https://www.youtube.com/watch?v=5cch_-3NVLk&ab_channel=JohnHammond)
[^2]: [Anti Reverse Engineering](https://youtu.be/WO-Rp6-1phw?si=GLowFed47wE44oQR)
