# Malware Analysis Method
#malware #analysis
- [[Malware Basics]]
---

## Static Analysis


- Packed files will run in memory unpacked [^1]

[^2]

1. Shows human readable strings
- `strings <file> | less`

2. Creates human readable section of file
- `objdump -d -Mintel <file>`

3. [[IDA]]

- `UPX` is one of the only packers with built-in unpacking `-d` [^1]
    - `upx -d file.exe`

#### Automated malware unpacking and artifact extraction
- [Ether](https://ether.gtisc.gatech.edu/)
- [UnpacMe](https://www.unpac.me/)


- `image-base` - virutal address where the executable is loaded in memory
    - ASLR - random the base address to make it harder to exploit the process [^1]
        - complicates unpacking and other code analysis
        - applied to `dll`'s first
        - win8+ applied to `.exe` also
        - you can disable ASLR for each malware sample
            1. [CFF Explorer](https://github.com/cybertechniques/site/blob/master/analysis_tools/cff-explorer/index.md)
                - optional Header
                - find DllCharacteristtics
                    - uncheck `DLL can move`
            2. `setdllcharacteristics -d %AppData%\<FILE>`
                - disabling `DynamicBase`
                


## Debugging/Disassembly
## Dynamic Analysis

#### setup programs to run before detonation
- [[FakeNet]]
- [[Process_Explorer]]
- [[Process_Hacker]]
- [[Reg_Shot]]
- [[Wireshark]]







[^1]: SANS FOR610 GREM
[^2]: [everything is open source if you can reverse engineer - Low Level](https://youtu.be/gh2RXE9BIN8?si=_hVG0pOae1bIhprA)